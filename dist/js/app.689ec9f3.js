(function(){var o={5358:function(o,e,a){var r={"./af":5177,"./af.js":5177,"./ar":1509,"./ar-dz":1488,"./ar-dz.js":1488,"./ar-kw":8676,"./ar-kw.js":8676,"./ar-ly":2353,"./ar-ly.js":2353,"./ar-ma":4496,"./ar-ma.js":4496,"./ar-ps":6947,"./ar-ps.js":6947,"./ar-sa":2682,"./ar-sa.js":2682,"./ar-tn":9756,"./ar-tn.js":9756,"./ar.js":1509,"./az":5533,"./az.js":5533,"./be":8959,"./be.js":8959,"./bg":7777,"./bg.js":7777,"./bm":4903,"./bm.js":4903,"./bn":1290,"./bn-bd":7357,"./bn-bd.js":7357,"./bn.js":1290,"./bo":1545,"./bo.js":1545,"./br":1470,"./br.js":1470,"./bs":4429,"./bs.js":4429,"./ca":7306,"./ca.js":7306,"./cs":6464,"./cs.js":6464,"./cv":3635,"./cv.js":3635,"./cy":4226,"./cy.js":4226,"./da":3601,"./da.js":3601,"./de":7853,"./de-at":6111,"./de-at.js":6111,"./de-ch":4697,"./de-ch.js":4697,"./de.js":7853,"./dv":708,"./dv.js":708,"./el":4691,"./el.js":4691,"./en-au":3872,"./en-au.js":3872,"./en-ca":8298,"./en-ca.js":8298,"./en-gb":6195,"./en-gb.js":6195,"./en-ie":6584,"./en-ie.js":6584,"./en-il":5543,"./en-il.js":5543,"./en-in":9033,"./en-in.js":9033,"./en-nz":9402,"./en-nz.js":9402,"./en-sg":3004,"./en-sg.js":3004,"./eo":2934,"./eo.js":2934,"./es":7650,"./es-do":838,"./es-do.js":838,"./es-mx":7730,"./es-mx.js":7730,"./es-us":6575,"./es-us.js":6575,"./es.js":7650,"./et":3035,"./et.js":3035,"./eu":3508,"./eu.js":3508,"./fa":119,"./fa.js":119,"./fi":527,"./fi.js":527,"./fil":5995,"./fil.js":5995,"./fo":2477,"./fo.js":2477,"./fr":5498,"./fr-ca":6435,"./fr-ca.js":6435,"./fr-ch":7892,"./fr-ch.js":7892,"./fr.js":5498,"./fy":7071,"./fy.js":7071,"./ga":1734,"./ga.js":1734,"./gd":217,"./gd.js":217,"./gl":7329,"./gl.js":7329,"./gom-deva":2124,"./gom-deva.js":2124,"./gom-latn":3383,"./gom-latn.js":3383,"./gu":5050,"./gu.js":5050,"./he":1713,"./he.js":1713,"./hi":3861,"./hi.js":3861,"./hr":6308,"./hr.js":6308,"./hu":609,"./hu.js":609,"./hy-am":7160,"./hy-am.js":7160,"./id":4063,"./id.js":4063,"./is":9374,"./is.js":9374,"./it":8383,"./it-ch":1827,"./it-ch.js":1827,"./it.js":8383,"./ja":3827,"./ja.js":3827,"./jv":9722,"./jv.js":9722,"./ka":1794,"./ka.js":1794,"./kk":7088,"./kk.js":7088,"./km":6870,"./km.js":6870,"./kn":4451,"./kn.js":4451,"./ko":3164,"./ko.js":3164,"./ku":8174,"./ku-kmr":6181,"./ku-kmr.js":6181,"./ku.js":8174,"./ky":8474,"./ky.js":8474,"./lb":9680,"./lb.js":9680,"./lo":5867,"./lo.js":5867,"./lt":5766,"./lt.js":5766,"./lv":9532,"./lv.js":9532,"./me":8076,"./me.js":8076,"./mi":1848,"./mi.js":1848,"./mk":306,"./mk.js":306,"./ml":3739,"./ml.js":3739,"./mn":9053,"./mn.js":9053,"./mr":6169,"./mr.js":6169,"./ms":3386,"./ms-my":2297,"./ms-my.js":2297,"./ms.js":3386,"./mt":7075,"./mt.js":7075,"./my":2264,"./my.js":2264,"./nb":2274,"./nb.js":2274,"./ne":8235,"./ne.js":8235,"./nl":2572,"./nl-be":3784,"./nl-be.js":3784,"./nl.js":2572,"./nn":4566,"./nn.js":4566,"./oc-lnc":9330,"./oc-lnc.js":9330,"./pa-in":9849,"./pa-in.js":9849,"./pl":4418,"./pl.js":4418,"./pt":9834,"./pt-br":8303,"./pt-br.js":8303,"./pt.js":9834,"./ro":4457,"./ro.js":4457,"./ru":2271,"./ru.js":2271,"./sd":1221,"./sd.js":1221,"./se":3478,"./se.js":3478,"./si":7538,"./si.js":7538,"./sk":5784,"./sk.js":5784,"./sl":6637,"./sl.js":6637,"./sq":6794,"./sq.js":6794,"./sr":5719,"./sr-cyrl":3322,"./sr-cyrl.js":3322,"./sr.js":5719,"./ss":6e3,"./ss.js":6e3,"./sv":1011,"./sv.js":1011,"./sw":748,"./sw.js":748,"./ta":1025,"./ta.js":1025,"./te":1885,"./te.js":1885,"./tet":8861,"./tet.js":8861,"./tg":6571,"./tg.js":6571,"./th":5802,"./th.js":5802,"./tk":9527,"./tk.js":9527,"./tl-ph":9231,"./tl-ph.js":9231,"./tlh":1052,"./tlh.js":1052,"./tr":5096,"./tr.js":5096,"./tzl":9846,"./tzl.js":9846,"./tzm":1765,"./tzm-latn":7711,"./tzm-latn.js":7711,"./tzm.js":1765,"./ug-cn":8414,"./ug-cn.js":8414,"./uk":6618,"./uk.js":6618,"./ur":158,"./ur.js":158,"./uz":7609,"./uz-latn":2475,"./uz-latn.js":2475,"./uz.js":7609,"./vi":1135,"./vi.js":1135,"./x-pseudo":4051,"./x-pseudo.js":4051,"./yo":2218,"./yo.js":2218,"./zh-cn":2648,"./zh-cn.js":2648,"./zh-hk":1632,"./zh-hk.js":1632,"./zh-mo":1541,"./zh-mo.js":1541,"./zh-tw":304,"./zh-tw.js":304};function l(o){var e=t(o);return a(e)}function t(o){if(!a.o(r,o)){var e=new Error("Cannot find module '"+o+"'");throw e.code="MODULE_NOT_FOUND",e}return r[o]}l.keys=function(){return Object.keys(r)},l.resolve=t,o.exports=l,l.id=5358},1139:function(o,e,a){"use strict";var r=a(3751),l=a(641),t=a(33);const i={id:"app"},s={key:0,class:"navbar"},n={class:"dropdown"},u=(0,l.Lk)("span",{class:"nav-link dropdown-toggle"},"Usuarios del Sistema",-1),c={key:0,class:"dropdown-content"},d={key:0,class:"dropdown"},m=(0,l.Lk)("span",{class:"nav-link dropdown-toggle"},"Perfil",-1),p={class:"dropdown-content"},h={class:"user-info"},f=(0,l.Lk)("strong",null,"Nombre: ",-1),k=(0,l.Lk)("strong",null,"Grado: ",-1),b={key:0},g=(0,l.Lk)("strong",null,"Rol: ",-1),v=(0,l.Lk)("strong",null,"Usuario: ",-1),L=(0,l.Lk)("div",{class:"dropdown-divider"},null,-1);function y(o,e,a,r,y,C){const V=(0,l.g2)("router-link"),U=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.CE)("div",i,[C.showNavbar?((0,l.uX)(),(0,l.CE)("nav",s,[(0,l.bF)(V,{to:"/formulario",class:"nav-link"},{default:(0,l.k6)((()=>[(0,l.eW)("Formulario")])),_:1}),(0,l.bF)(V,{to:"/hechos",class:"nav-link"},{default:(0,l.k6)((()=>[(0,l.eW)("Hechos")])),_:1}),(0,l.Lk)("div",n,[u,y.isAdmin?((0,l.uX)(),(0,l.CE)("div",c,[(0,l.bF)(V,{to:"/register",class:"nav-link"},{default:(0,l.k6)((()=>[(0,l.eW)("Registrar Usuario")])),_:1}),(0,l.bF)(V,{to:"/usuarios",class:"nav-link"},{default:(0,l.k6)((()=>[(0,l.eW)("Usuarios Registrados")])),_:1})])):(0,l.Q3)("",!0)]),y.loggedIn?((0,l.uX)(),(0,l.CE)("div",d,[m,(0,l.Lk)("div",p,[(0,l.Lk)("div",h,[(0,l.Lk)("p",null,[f,(0,l.eW)((0,t.v_)(y.userData.nombre)+" "+(0,t.v_)(y.userData.apellidos),1)]),(0,l.Lk)("p",null,[k,(0,l.eW)((0,t.v_)(y.userData.grado),1)]),y.isAdmin?((0,l.uX)(),(0,l.CE)("p",b,[g,(0,l.eW)("Administrador")])):(0,l.Q3)("",!0),(0,l.Lk)("p",null,[v,(0,l.eW)((0,t.v_)(y.userData.usuario),1)])]),L,(0,l.Lk)("a",{href:"#",onClick:e[0]||(e[0]=(...o)=>C.logout&&C.logout(...o)),class:"dropdown-item"},"Cerrar Sesión")])])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0),(0,l.bF)(U,{userData:y.userData,loggedIn:y.loggedIn,isAdmin:y.isAdmin,onLoginSuccess:C.fetchUserData},null,8,["userData","loggedIn","isAdmin","onLoginSuccess"])])}var C={name:"App",data(){return{loggedIn:!1,userData:{},isAdmin:!1}},computed:{showNavbar(){return"/"!==this.$route.path}},methods:{logout(){localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("userData"),this.loggedIn=!1,this.userData={},this.isAdmin=!1,this.$router.push("/")},fetchUserData(){const o=localStorage.getItem("userId"),e=localStorage.getItem("token"),a=localStorage.getItem("userData");if(o&&e&&a)try{this.userData=JSON.parse(a),this.loggedIn=!0,this.isAdmin="administrador"===this.userData.rol}catch(r){console.error("Error al analizar userData:",r),this.loggedIn=!1,this.isAdmin=!1}else this.logout()}},created(){this.fetchUserData(),window.addEventListener("beforeunload",(()=>{this.logout()}))}},V=a(6262);const U=(0,V.A)(C,[["render",y]]);var j=U,I=a(5220);const E=o=>((0,l.Qi)("data-v-06ca3d08"),o=o(),(0,l.jt)(),o),w={class:"inicio-sesion-container"},D={class:"inicio-sesion"},A=E((()=>(0,l.Lk)("h2",null,"Inicio de Sesión",-1))),F={class:"form-group"},N=E((()=>(0,l.Lk)("label",{for:"usuario"},"Usuario:",-1))),J={class:"form-group"},x=E((()=>(0,l.Lk)("label",{for:"password"},"Contraseña:",-1))),S={class:"password-wrapper"},z=["type"],X={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",width:"24",height:"24"},H=E((()=>(0,l.Lk)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12 5C7.0589 5 2.9411 7.5139 1 12c1.9411 4.4861 6.0589 7 11 7s9.0589-2.5139 11-7c-1.9411-4.4861-6.0589-7-11-7zm0 2c2.2203 0 4.2674.888 5.814 2.3399-1.5531 1.4497-3.5946 2.3156-5.814 2.3156s-4.2609-.8659-5.814-2.3156C7.7326 7.888 9.7797 7 12 7zm-1 3h2v2h-2v-2zm2 6c-2.4853 0-4.5-2.0147-4.5-4.5S10.5147 7.5 13 7.5 17.5 9.5147 17.5 12 15.4853 16 13 16z"},null,-1))),_=[H],B={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",width:"24",height:"24"},R=E((()=>(0,l.Lk)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12 5C7.0589 5 2.9411 7.5139 1 12c1.9411 4.4861 6.0589 7 11 7s9.0589-2.5139 11-7c-1.9411-4.4861-6.0589-7-11-7zm0 2c2.2203 0 4.2674.888 5.814 2.3399-1.5531 1.4497-3.5946 2.3156-5.814 2.3156s-4.2609-.8659-5.814-2.3156C7.7326 7.888 9.7797 7 12 7zm-1 3h2v2h-2v-2zm2 6c-2.4853 0-4.5-2.0147-4.5-4.5S10.5147 7.5 13 7.5 17.5 9.5147 17.5 12 15.4853 16 13 16z"},null,-1))),G=[R],Q=E((()=>(0,l.Lk)("button",{type:"submit",class:"btn-iniciar-sesion"},"Iniciar Sesión",-1)));function O(o,e,a,t,i,s){return(0,l.uX)(),(0,l.CE)("div",w,[(0,l.Lk)("div",D,[A,(0,l.Lk)("form",{onSubmit:e[3]||(e[3]=(0,r.D$)(((...o)=>s.login&&s.login(...o)),["prevent"]))},[(0,l.Lk)("div",F,[N,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"usuario","onUpdate:modelValue":e[0]||(e[0]=o=>i.usuario=o),autocomplete:"off",required:""},null,512),[[r.Jo,i.usuario]])]),(0,l.Lk)("div",J,[x,(0,l.Lk)("div",S,[(0,l.bo)((0,l.Lk)("input",{type:s.passwordFieldType,id:"password","onUpdate:modelValue":e[1]||(e[1]=o=>i.password=o),autocomplete:"off",required:""},null,8,z),[[r.hp,i.password]]),(0,l.Lk)("span",{onClick:e[2]||(e[2]=(...o)=>s.togglePasswordVisibility&&s.togglePasswordVisibility(...o)),class:"password-toggle"},[i.showPassword?((0,l.uX)(),(0,l.CE)("svg",X,_)):((0,l.uX)(),(0,l.CE)("svg",B,G))])])]),Q],32)])])}var P=a(4335),$=a(5246),Z={name:"Login",data(){return{usuario:"",password:"",showPassword:!1}},setup(){const o=(0,I.rd)(),e=(0,$.dj)();return{router:o,toast:e}},computed:{passwordFieldType(){return this.showPassword?"text":"password"}},methods:{togglePasswordVisibility(){this.showPassword=!this.showPassword},async login(){try{const o=await P.A.post("http://127.0.0.1:5000/api/usuarios/login",{usuario:this.usuario,password:this.password});if(o.data.token&&o.data.userId&&o.data.userData){localStorage.setItem("token",o.data.token),localStorage.setItem("userId",o.data.userId),localStorage.setItem("userData",JSON.stringify(o.data.userData));const e=JSON.parse(localStorage.getItem("userData"));console.log("Rol del usuario:",e.rol),this.toast.success("Inicio de sesión correcto"),this.$emit("loginSuccess"),this.router.push("/formulario")}else this.toast.error("Credenciales inválidas")}catch(o){console.error("Error al iniciar sesión:",o),this.toast.error("Error al iniciar sesión")}}}};const T=(0,V.A)(Z,[["render",O],["__scopeId","data-v-06ca3d08"]]);var q=T;const M=o=>((0,l.Qi)("data-v-20445f17"),o=o(),(0,l.jt)(),o),W={class:"registro-usuario-container"},Y={class:"registro-usuario"},K=M((()=>(0,l.Lk)("h2",null,"Registro de Usuario",-1))),oo={class:"form-group"},eo=M((()=>(0,l.Lk)("label",{for:"nombre"},"Nombre:",-1))),ao={class:"form-group"},ro=M((()=>(0,l.Lk)("label",{for:"apellidos"},"Apellidos:",-1))),lo={class:"form-group"},to=M((()=>(0,l.Lk)("label",{for:"carnet"},"Carnet de Identidad:",-1))),io={class:"form-group"},so=M((()=>(0,l.Lk)("label",{for:"grado"},"Grado:",-1))),no={class:"form-group"},uo=M((()=>(0,l.Lk)("label",{for:"rol"},"Rol:",-1))),co=M((()=>(0,l.Lk)("option",{value:"usuario"},"Usuario",-1))),mo=M((()=>(0,l.Lk)("option",{value:"administrador"},"Administrador",-1))),po=[co,mo],ho={class:"form-group"},fo=M((()=>(0,l.Lk)("label",{for:"usuario"},"Usuario:",-1))),ko={class:"form-group"},bo=M((()=>(0,l.Lk)("label",{for:"password"},"Contraseña:",-1))),go={key:0},vo=M((()=>(0,l.Lk)("button",{type:"submit",class:"btn-registrar"},"Registrar",-1)));function Lo(o,e,a,i,s,n){return(0,l.uX)(),(0,l.CE)("div",W,[(0,l.Lk)("div",Y,[K,(0,l.Lk)("form",{onSubmit:e[7]||(e[7]=(0,r.D$)(((...o)=>n.register&&n.register(...o)),["prevent"]))},[(0,l.Lk)("div",oo,[eo,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"nombre","onUpdate:modelValue":e[0]||(e[0]=o=>s.nombre=o),required:"",autocomplete:"off"},null,512),[[r.Jo,s.nombre]])]),(0,l.Lk)("div",ao,[ro,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"apellidos","onUpdate:modelValue":e[1]||(e[1]=o=>s.apellidos=o),required:"",autocomplete:"off"},null,512),[[r.Jo,s.apellidos]])]),(0,l.Lk)("div",lo,[to,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"carnet","onUpdate:modelValue":e[2]||(e[2]=o=>s.carnet=o),required:"",autocomplete:"off"},null,512),[[r.Jo,s.carnet]])]),(0,l.Lk)("div",io,[so,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"grado","onUpdate:modelValue":e[3]||(e[3]=o=>s.grado=o),required:"",autocomplete:"off"},null,512),[[r.Jo,s.grado]])]),(0,l.Lk)("div",no,[uo,(0,l.bo)((0,l.Lk)("select",{id:"rol","onUpdate:modelValue":e[4]||(e[4]=o=>s.rol=o),required:""},po,512),[[r.u1,s.rol]])]),(0,l.Lk)("div",ho,[fo,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"usuario","onUpdate:modelValue":e[5]||(e[5]=o=>s.usuario=o),required:"",autocomplete:"off"},null,512),[[r.Jo,s.usuario]])]),(0,l.Lk)("div",ko,[bo,(0,l.bo)((0,l.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":e[6]||(e[6]=o=>s.password=o),required:"",autocomplete:"off"},null,512),[[r.Jo,s.password]]),s.passwordMessage?((0,l.uX)(),(0,l.CE)("small",go,(0,t.v_)(s.passwordMessage),1)):(0,l.Q3)("",!0)]),vo],32)])])}var yo={data(){return{nombre:"",apellidos:"",carnet:"",grado:"",rol:"usuario",usuario:"",password:"",passwordMessage:""}},watch:{password(o){this.validatePassword(o)}},methods:{validatePassword(o){const e=[{regex:/.{8,}/,message:"Debe tener al menos 8 caracteres"},{regex:/[A-Z]/,message:"Debe tener al menos una letra mayúscula"},{regex:/\d/,message:"Debe tener al menos un número"}];this.passwordMessage=e.filter((e=>!e.regex.test(o))).map((o=>o.message)).join(", ")},async register(){const o=(0,$.dj)();if(this.passwordMessage)o.error("La contraseña no cumple con las condiciones necesarias");else try{const e=await P.A.post("http://127.0.0.1:5000/api/usuarios/register",{nombre:this.nombre,apellidos:this.apellidos,carnet:this.carnet,grado:this.grado,rol:this.rol,usuario:this.usuario,password:this.password});console.log(e.data),o.success("Usuario registrado exitosamente"),this.clearForm(),this.$router.push("/")}catch(e){o.error(e.response?.data?.message||"Error al registrar el usuario")}},clearForm(){this.nombre="",this.apellidos="",this.carnet="",this.grado="",this.rol="usuario",this.usuario="",this.password="",this.errorMessage="",this.passwordMessage=""}}};const Co=(0,V.A)(yo,[["render",Lo],["__scopeId","data-v-20445f17"]]);var Vo=Co;const Uo=o=>((0,l.Qi)("data-v-7ef11d7d"),o=o(),(0,l.jt)(),o),jo={class:"formulario"},Io={class:"form-container"},Eo=Uo((()=>(0,l.Lk)("h1",null,"CERTIFICADO DE ACCIDENTES DE TRÁNSITO - SOAT",-1))),wo=Uo((()=>(0,l.Lk)("h3",null,"EL JEFE DE LA DIVISIÓN DE ACCIDENTES DE LA DIRECCIÓN DEPARTAMENTAL DE TRÁNSITO DE LA CIUDAD DE LA PAZ, EN CUANTO PUEDE Y EL DERECHO LE PERMITE:",-1))),Do=Uo((()=>(0,l.Lk)("h2",null,"CERTIFICA:",-1))),Ao=Uo((()=>(0,l.Lk)("p",null,[(0,l.Lk)("strong",null,"1. Datos del Hecho de Tránsito")],-1))),Fo=Uo((()=>(0,l.Lk)("label",{for:"denunciante"},"Denunciante:",-1))),No=Uo((()=>(0,l.Lk)("label",{for:"casoNumero"},"Caso N°:",-1))),Jo=Uo((()=>(0,l.Lk)("label",{for:"naturaleza"},"Naturaleza del Hecho:",-1))),xo=Uo((()=>(0,l.Lk)("label",{for:"departamento"},"Departamento:",-1))),So=(0,l.Fv)('<option value="La Paz" data-v-7ef11d7d>La Paz</option><option value="Cochabamba" data-v-7ef11d7d>Cochabamba</option><option value="Santa Cruz" data-v-7ef11d7d>Santa Cruz</option><option value="Oruro" data-v-7ef11d7d>Oruro</option><option value="Potosi" data-v-7ef11d7d>Potosí</option><option value="Tarija" data-v-7ef11d7d>Tarija</option><option value="Beni" data-v-7ef11d7d>Beni</option><option value="Pando" data-v-7ef11d7d>Pando</option><option value="Chuquisaca" data-v-7ef11d7d>Chuquisaca</option>',9),zo=[So],Xo=Uo((()=>(0,l.Lk)("label",{for:"estacionPolicial"},"Estación Policial:",-1))),Ho=Uo((()=>(0,l.Lk)("label",{for:"lugar"},"Lugar del Hecho:",-1))),_o=Uo((()=>(0,l.Lk)("label",{for:"diaHoraFecha"},"Día, Hora y Fecha del Hecho:",-1))),Bo=Uo((()=>(0,l.Lk)("div",null,[(0,l.Lk)("p",null,[(0,l.Lk)("strong",null,"2. Datos de los Vehículos")])],-1))),Ro=["for"],Go=["id","onUpdate:modelValue"],Qo=["onClick"],Oo={key:0},Po=Uo((()=>(0,l.Lk)("h3",null,"Vehículos:",-1))),$o=Uo((()=>(0,l.Lk)("label",{for:"empresa"},"Empresa o Institución a la que pertenece el vehículo:",-1))),Zo=["onUpdate:modelValue"],To=Uo((()=>(0,l.Lk)("label",{for:"tipoUso"},"Tipo de servicio:",-1))),qo=["id","onUpdate:modelValue"],Mo=Uo((()=>(0,l.Lk)("option",{value:"Particular"},"Particular",-1))),Wo=Uo((()=>(0,l.Lk)("option",{value:"Público"},"Público",-1))),Yo=[Mo,Wo],Ko=Uo((()=>(0,l.Lk)("div",null,[(0,l.Lk)("p",null,[(0,l.Lk)("strong",null,"3. Datos de los Conductores")])],-1))),oe=["for"],ee=["id","onUpdate:modelValue"],ae=["onClick"],re={key:1},le=Uo((()=>(0,l.Lk)("h3",null,"Conductores:",-1))),te=["for"],ie=["id","onUpdate:modelValue"],se=["for"],ne=["id","onUpdate:modelValue"],ue=(0,l.Fv)('<option value="A" data-v-7ef11d7d>A</option><option value="B" data-v-7ef11d7d>B</option><option value="C" data-v-7ef11d7d>C</option><option value="P" data-v-7ef11d7d>P</option><option value="M" data-v-7ef11d7d>M</option>',5),ce=[ue],de=["for"],me=["id","onUpdate:modelValue"],pe=["for"],he=["id","onUpdate:modelValue"],fe=["for"],ke=["id","onUpdate:modelValue"],be=["for"],ge=["id","onUpdate:modelValue"],ve=["for"],Le=["id","onUpdate:modelValue"],ye=["value"],Ce=Uo((()=>(0,l.Lk)("p",null,[(0,l.Lk)("strong",null,"4. Breve detalle del hecho")],-1))),Ve=Uo((()=>(0,l.Lk)("label",{for:"detalle"},"Detalle del Hecho:",-1))),Ue=Uo((()=>(0,l.Lk)("div",null,[(0,l.Lk)("p",null,[(0,l.Lk)("strong",null,"5. Víctimas del hecho")])],-1))),je=["for"],Ie=["id","onUpdate:modelValue"],Ee=["onClick"],we={key:2},De=Uo((()=>(0,l.Lk)("h3",null,"Víctimas:",-1))),Ae=["for"],Fe=["id","onUpdate:modelValue"],Ne=Uo((()=>(0,l.Lk)("option",{value:"Fallecido"},"Fallecido",-1))),Je=Uo((()=>(0,l.Lk)("option",{value:"Herido"},"Herido",-1))),xe=[Ne,Je],Se=["for"],ze=["id","onUpdate:modelValue"],Xe=Uo((()=>(0,l.Lk)("option",{value:"Peatón"},"Peatón",-1))),He=Uo((()=>(0,l.Lk)("option",{value:"Pasajero"},"Pasajero",-1))),_e=Uo((()=>(0,l.Lk)("option",{value:"Conductor"},"Conductor",-1))),Be=[Xe,He,_e],Re=["for"],Ge=["id","onUpdate:modelValue"],Qe=Uo((()=>(0,l.Lk)("option",{value:"Sin Vehiculo"},"Sin Vehículo",-1))),Oe=["value"],Pe=["for"],$e=["id","onUpdate:modelValue"],Ze=Uo((()=>(0,l.Lk)("label",{for:"fechaRegistro"},"Fecha y Hora del Registro en el Sistema:",-1))),Te=Uo((()=>(0,l.Lk)("label",{for:"usuario"},"Usuario:",-1))),qe=["value"],Me=Uo((()=>(0,l.Lk)("p",null,[(0,l.Lk)("strong",null,"6. Observaciones")],-1))),We=Uo((()=>(0,l.Lk)("label",{for:"comentarios"},"Comentarios Adicionales (Opcional):",-1))),Ye=Uo((()=>(0,l.Lk)("button",{type:"submit"},"Enviar",-1)));function Ke(o,e,a,i,s,n){return(0,l.uX)(),(0,l.CE)("div",jo,[(0,l.Lk)("div",Io,[Eo,(0,l.Lk)("form",{onSubmit:e[13]||(e[13]=(0,r.D$)(((...o)=>n.submitFormulario&&n.submitFormulario(...o)),["prevent"]))},[wo,Do,Ao,(0,l.Lk)("div",null,[(0,l.Lk)("div",null,[Fo,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"denunciante","onUpdate:modelValue":e[0]||(e[0]=o=>s.formulario.hechos.denunciante=o),maxlength:"500",class:"input",autocomplete:"off"},null,512),[[r.Jo,s.formulario.hechos.denunciante]])]),(0,l.Lk)("div",null,[No,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"casoNumero","onUpdate:modelValue":e[1]||(e[1]=o=>s.formulario.hechos.casoNumero=o),class:"input",autocomplete:"off",placeholder:"Mínimo 10 caracteres"},null,512),[[r.Jo,s.formulario.hechos.casoNumero]])]),(0,l.Lk)("div",null,[Jo,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"naturaleza","onUpdate:modelValue":e[2]||(e[2]=o=>s.formulario.hechos.naturaleza=o),maxlength:"500",class:"input",autocomplete:"off"},null,512),[[r.Jo,s.formulario.hechos.naturaleza]])]),(0,l.Lk)("div",null,[xo,(0,l.bo)((0,l.Lk)("select",{id:"departamento","onUpdate:modelValue":e[3]||(e[3]=o=>s.formulario.hechos.departamento=o),maxlength:"50",class:"input",autocomplete:"off"},zo,512),[[r.u1,s.formulario.hechos.departamento]])]),(0,l.Lk)("div",null,[Xo,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"estacionPolicial","onUpdate:modelValue":e[4]||(e[4]=o=>s.formulario.hechos.estacionPolicial=o),maxlength:"500",class:"input",autocomplete:"off"},null,512),[[r.Jo,s.formulario.hechos.estacionPolicial]])]),(0,l.Lk)("div",null,[Ho,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"lugar","onUpdate:modelValue":e[5]||(e[5]=o=>s.formulario.hechos.lugar=o),maxlength:"500",class:"input",autocomplete:"off"},null,512),[[r.Jo,s.formulario.hechos.lugar]])]),(0,l.Lk)("div",null,[_o,(0,l.bo)((0,l.Lk)("input",{type:"datetime-local",id:"diaHoraFecha","onUpdate:modelValue":e[6]||(e[6]=o=>s.formulario.hechos.diaHoraFecha=o),class:"input",autocomplete:"off"},null,512),[[r.Jo,s.formulario.hechos.diaHoraFecha]])])]),Bo,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.formulario.vehiculos,((o,e)=>((0,l.uX)(),(0,l.CE)("div",{key:e},[(0,l.Lk)("label",{for:"vehiculo"+e},"Placa del Vehículo "+(0,t.v_)(e+1)+":",9,Ro),(0,l.bo)((0,l.Lk)("input",{id:"vehiculo"+e,"onUpdate:modelValue":e=>o.placa=e,class:"input",autocomplete:"off"},null,8,Go),[[r.Jo,o.placa]]),(0,l.Lk)("button",{type:"button",onClick:o=>n.confirmarBuscarVehiculo(e)},"Buscar",8,Qo)])))),128)),s.vehiculosEncontrados.length>0?((0,l.uX)(),(0,l.CE)("div",Oo,[Po,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.vehiculosEncontrados,((o,e)=>((0,l.uX)(),(0,l.CE)("div",{key:e,class:"input"},[(0,l.Lk)("h3",null,"Vehículo "+(0,t.v_)(e+1)+":",1),(0,l.Lk)("p",null,"Placa: "+(0,t.v_)(o.placa),1),(0,l.Lk)("p",null,"Marca: "+(0,t.v_)(o.marca),1),(0,l.Lk)("p",null,"Modelo: "+(0,t.v_)(o.modelo),1),(0,l.Lk)("p",null,"Tipo Vehículo: "+(0,t.v_)(o.clase),1),(0,l.Lk)("p",null,"Color: "+(0,t.v_)(o.color),1),$o,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"empresa","onUpdate:modelValue":o=>s.formulario.vehiculos[e].empresa=o,class:"input",autocomplete:"off"},null,8,Zo),[[r.Jo,s.formulario.vehiculos[e].empresa]]),To,(0,l.bo)((0,l.Lk)("select",{id:"tipoUso"+e,"onUpdate:modelValue":o=>s.formulario.vehiculos[e].tipoUso=o,class:"input",autocomplete:"off"},Yo,8,qo),[[r.u1,s.formulario.vehiculos[e].tipoUso]])])))),128)),(0,l.Lk)("button",{type:"button",onClick:e[7]||(e[7]=(...o)=>n.agregarVehiculo&&n.agregarVehiculo(...o))},"+ Registrar otro vehículo")])):(0,l.Q3)("",!0),Ko,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.formulario.conductores,((o,e)=>((0,l.uX)(),(0,l.CE)("div",{key:e},[(0,l.Lk)("label",{for:"conductor"+e},"CI del Conductor "+(0,t.v_)(e+1)+":",9,oe),(0,l.bo)((0,l.Lk)("input",{id:"conductor"+e,"onUpdate:modelValue":e=>o.ci=e,class:"input",autocomplete:"off"},null,8,ee),[[r.Jo,o.ci,void 0,{number:!0}]]),(0,l.Lk)("button",{type:"button",onClick:o=>n.confirmarBuscarConductor(e)},"Buscar",8,ae)])))),128)),s.conductoresEncontrados.length>0?((0,l.uX)(),(0,l.CE)("div",re,[le,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.conductoresEncontrados,((o,e)=>((0,l.uX)(),(0,l.CE)("div",{key:e,class:"input"},[(0,l.Lk)("h3",null,"Conductor "+(0,t.v_)(e+1)+":",1),(0,l.Lk)("p",null,"Nombre: "+(0,t.v_)(o.nombre),1),(0,l.Lk)("p",null,"CI: "+(0,t.v_)(o.ci),1),(0,l.Lk)("p",null,"Edad: "+(0,t.v_)(o.edad),1),(0,l.Lk)("p",null,"Domicilio: "+(0,t.v_)(o.domicilio),1),(0,l.Lk)("label",{for:"licencia"+e},"Licencia de Conducir N°:",8,te),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"licencia"+e,"onUpdate:modelValue":o=>s.formulario.conductores[e].licencia=o,class:"input",autocomplete:"off"},null,8,ie),[[r.Jo,s.formulario.conductores[e].licencia]]),(0,l.Lk)("label",{for:"categoria"+e},"Categoría:",8,se),(0,l.bo)((0,l.Lk)("select",{id:"categoria"+e,"onUpdate:modelValue":o=>s.formulario.conductores[e].categoria=o,class:"input"},ce,8,ne),[[r.u1,s.formulario.conductores[e].categoria]]),(0,l.Lk)("label",{for:"licDesde"+e},"Licencia de Conducir con Vigencia desde:",8,de),(0,l.bo)((0,l.Lk)("input",{type:"date",id:"licDesde"+e,"onUpdate:modelValue":e=>o.licDesde=e,class:"input",autocomplete:"off"},null,8,me),[[r.Jo,o.licDesde]]),(0,l.Lk)("label",{for:"licHasta"+e},"Licencia de Conducir con Vigencia hasta:",8,pe),(0,l.bo)((0,l.Lk)("input",{type:"date",id:"licHasta"+e,"onUpdate:modelValue":e=>o.licHasta=e,class:"input",autocomplete:"off"},null,8,he),[[r.Jo,o.licHasta]]),(0,l.Lk)("label",{for:"alcoholemia"+e},"Resultado Test de Alcoholemia:",8,fe),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"alcoholemia"+e,"onUpdate:modelValue":o=>s.formulario.conductores[e].alcoholemia=o,maxlength:"500",class:"input",autocomplete:"off"},null,8,ke),[[r.Jo,s.formulario.conductores[e].alcoholemia]]),(0,l.Lk)("label",{for:"alcoholemiaHora"+e},"Realizado:",8,be),(0,l.bo)((0,l.Lk)("input",{type:"datetime-local",id:"alcoholemiaHora"+e,"onUpdate:modelValue":o=>s.formulario.conductores[e].alcoholemiaHora=o,class:"input",autocomplete:"off"},null,8,ge),[[r.Jo,s.formulario.conductores[e].alcoholemiaHora]]),(0,l.Lk)("label",{for:"vehiculoCorrespondeConductor"+e},"Vehículo al que Correspondía:",8,ve),(0,l.bo)((0,l.Lk)("select",{id:"vehiculoCorrespondeConductor"+e,"onUpdate:modelValue":o=>s.formulario.conductores[e].vehiculoCorrespondeConductor=o,class:"input"},[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.formulario.vehiculos,((o,e)=>((0,l.uX)(),(0,l.CE)("option",{key:e,value:o.placa},(0,t.v_)(o.placa),9,ye)))),128))],8,Le),[[r.u1,s.formulario.conductores[e].vehiculoCorrespondeConductor]])])))),128)),(0,l.Lk)("button",{type:"button",onClick:e[8]||(e[8]=(...o)=>n.agregarConductor&&n.agregarConductor(...o))},"+ Agregar Conductor")])):(0,l.Q3)("",!0),Ce,(0,l.Lk)("div",null,[Ve,(0,l.bo)((0,l.Lk)("textarea",{id:"detalle","onUpdate:modelValue":e[9]||(e[9]=o=>s.formulario.detalle=o),maxlength:"5000",class:"textarea"},null,512),[[r.Jo,s.formulario.detalle]])]),Ue,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.formulario.victimas,((o,e)=>((0,l.uX)(),(0,l.CE)("div",{key:e},[(0,l.Lk)("label",{for:"victima"+e},"CI de la Víctima "+(0,t.v_)(e+1)+":",9,je),(0,l.bo)((0,l.Lk)("input",{id:"victima"+e,"onUpdate:modelValue":e=>o.ci=e,class:"input",autocomplete:"off"},null,8,Ie),[[r.Jo,o.ci]]),(0,l.Lk)("button",{type:"button",onClick:o=>n.confirmarBuscarVictima(e)},"Buscar",8,Ee)])))),128)),s.victimasEncontradas.length>0?((0,l.uX)(),(0,l.CE)("div",we,[De,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.victimasEncontradas,((o,e)=>((0,l.uX)(),(0,l.CE)("div",{key:e,class:"input"},[(0,l.Lk)("h3",null,"Víctima "+(0,t.v_)(e+1)+":",1),(0,l.Lk)("p",null,"Nombre: "+(0,t.v_)(o.nombre),1),(0,l.Lk)("p",null,"CI: "+(0,t.v_)(o.ci),1),(0,l.Lk)("p",null,"Edad: "+(0,t.v_)(o.edad),1),(0,l.Lk)("p",null,"Domicilio: "+(0,t.v_)(o.domicilio),1),(0,l.Lk)("label",{for:"fallecidoHerido"+e},"Fallecido o Herido:",8,Ae),(0,l.bo)((0,l.Lk)("select",{id:"fallecidoHerido"+e,"onUpdate:modelValue":e=>o.fallecidoHerido=e,class:"input"},xe,8,Fe),[[r.u1,o.fallecidoHerido]]),(0,l.Lk)("label",{for:"tipoVictima"+e},"Tipo de Víctima:",8,Se),(0,l.bo)((0,l.Lk)("select",{id:"tipoVictima"+e,"onUpdate:modelValue":e=>o.tipoVictima=e,class:"input"},Be,8,ze),[[r.u1,o.tipoVictima]]),(0,l.Lk)("label",{for:"vehiculoCorrespondeVictima"+e},"Vehículo al que Correspondía:",8,Re),(0,l.bo)((0,l.Lk)("select",{id:"vehiculoCorrespondeVictima"+e,"onUpdate:modelValue":e=>o.vehiculoCorrespondeVictima=e,class:"input"},[Qe,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.formulario.vehiculos,((o,e)=>((0,l.uX)(),(0,l.CE)("option",{key:e,value:o.placa},(0,t.v_)(o.placa),9,Oe)))),128))],8,Ge),[[r.u1,o.vehiculoCorrespondeVictima]]),(0,l.Lk)("label",{for:"auxiliado"+e},"Auxiliado a:",8,Pe),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"auxiliado"+e,"onUpdate:modelValue":e=>o.auxiliado=e,class:"input",autocomplete:"off"},null,8,$e),[[r.Jo,o.auxiliado]])])))),128)),(0,l.Lk)("button",{type:"button",onClick:e[10]||(e[10]=(...o)=>n.agregarVictima&&n.agregarVictima(...o))},"+ Agregar Víctima")])):(0,l.Q3)("",!0),(0,l.Lk)("div",null,[Ze,(0,l.bo)((0,l.Lk)("input",{type:"datetime-local",id:"fechaRegistro","onUpdate:modelValue":e[11]||(e[11]=o=>s.formulario.fechaRegistro=o),class:"input",autocomplete:"off"},null,512),[[r.Jo,s.formulario.fechaRegistro]])]),(0,l.Lk)("div",null,[Te,(0,l.Lk)("input",{type:"text",id:"usuario",value:s.usuario,readonly:"",class:"input",autocomplete:"off"},null,8,qe)]),Me,(0,l.Lk)("div",null,[We,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"comentarios","onUpdate:modelValue":e[12]||(e[12]=o=>s.formulario.comentarios=o),maxlength:"1000",class:"input"},null,512),[[r.Jo,s.formulario.comentarios]])]),Ye],32)])])}var oa={name:"Formulario",props:{userData:Object},data(){return{formulario:{hechos:{denunciante:"",casoNumero:"",naturaleza:"",lugar:"",diaHoraFecha:"",departamento:"",estacionPolicial:"",relato:""},vehiculos:[{placa:"",marca:"",modelo:"",clase:"",color:"",empresa:"",tipoUso:""}],conductores:[{ci:"",nombre:"",edad:"",domicilio:"",licencia:"",categoria:"",alcoholemia:"",alcoholemiaHora:"",vehiculoCorrespondeConductor:"",licDesde:"",licHasta:""}],detalle:"",victimas:[{nombre:"",ci:"",edad:"",domicilio:"",fallecidoHerido:"",tipoVictima:"",vehiculoCorrespondeVictima:"",auxiliado:""}],fechaRegistro:"",usuario:"",comentarios:""},usuario:`${this.userData.grado} ${this.userData.nombre} ${this.userData.apellidos}`,vehiculosEncontrados:[],conductoresEncontrados:[],victimasEncontradas:[]}},mounted(){const o=JSON.parse(localStorage.getItem("userData"));this.formulario.usuario=` ${o.grado} ${o.nombre} ${o.apellidos}`},computed:{actualDate(){return(new Date).toISOString().slice(0,16)}},methods:{async submitFormulario(){const o=confirm("¿Está seguro de los datos ingresados? Éstos no se pueden modificar más adelante.");if(!o)return;const e={hechos:this.formulario.hechos,vehiculos:this.formulario.vehiculos,conductores:this.formulario.conductores,detalle:this.formulario.detalle,victimas:this.formulario.victimas,usuario:this.usuario,fechaRegistro:this.formulario.fechaRegistro,comentarios:this.formulario.comentarios};console.log(this.formulario),console.log("Datos enviados: ",e);try{const o=await P.A.post("http://127.0.0.1:5000/api/accidentes",this.formulario);console.log("response",o),alert("Formulario enviado exitosamente"),this.$router.push("/hechos")}catch(a){console.error("Error al enviar el formulario:",a),alert("Error al enviar el formulario. Revisa la consola para más detalles.")}},confirmarBuscarVehiculo(o){const e=this.formulario.vehiculos[o].placa,a=confirm(`El dato de la placa a buscar es ${e}, ¿Está seguro?`);a&&this.buscarVehiculo(o)},async buscarVehiculo(o){const e=this.formulario.vehiculos[o],a={contrasenia:"d1u4EeXYnp8Xy5h2xWbTz4o0X8EfUhihOwF7Ejd9wrJYQNXkbzCVG7PU7AWndEMDJujblbUcQnO884pdlEMA==",usuario:"MinGobDNFRServicio",token_key_MG:"P7ehC5HPARluSshmhjb4rmfULceEqO0ku5QhT5iXs3YAMlEUiEbYd6CwQKKrb2RvoT4hHz1Hw6Pm8pRMbshjw==",placa:e.placa};try{const r=await P.A.post("https://srvweb.policiadnfr.gob.bo/api/ConsultaVehiculo/ServicioMinGob",a);if(r.data&&r.data.datos_vehiculo){const a=r.data.datos_vehiculo;delete a.fotografia;const l=this.vehiculosEncontrados.find((o=>o.placa===e.placa));l?alert("El vehículo ya ha sido agregado."):(this.formulario.vehiculos.splice(o,1,a),this.vehiculosEncontrados.push(a))}else console.log("No se encontraron datos del vehículo")}catch(r){console.error("Error al buscar el vehículo:",r)}},agregarVehiculo(){this.formulario.vehiculos.push({placa:""})},confirmarBuscarConductor(o){const e=this.formulario.conductores[o].ci,a=confirm(`El dato del CI a buscar es ${e}, ¿Está seguro?`);a&&this.buscarConductor(o)},async buscarConductor(o){try{const e=this.formulario.conductores[o].ci;if(!e)return void alert("CI del conductor es requerido");const a=await P.A.post("http://localhost:5000/segip_service",{ced:e,com:"",nom:"",pat:"",mat:"",fnac:""},{headers:{Authorization:"Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6InNpZy1ycy0wIn0.eyJ1c2VyIjoic29hdCIsInNlcnZpY2UiOiJDZXJ0aWZpY2FkbyBkZSBBY2NpZGVudGVzIGRlIFRyw6Fuc2l0byBTT0FUIiwiaWF0IjoxNzE5NDA3NzI5LCJhdWQiOiJTZXJ2aWNpbyBkZSBJZGVudGlmaWNhY2lvbiBkZSBQZXJzb25hcyIsImlzcyI6Ik1pbmlzdGVyaW8gZGUgR29iaWVybm8ifQ.YmXEQ8LpgNQxsURar6wK6bumB0VJA4ZG6JtqDWjbaNoNGj5Qjs7LHBXeedjHb4BxFj6jgIlpp71r2cjFxlqfehnsVUqNLtqyCz6FmGsiImNJl_Gw-Ll_4Z86Dkjn0X3HGpsG69scUztEW4kC8U1LtlsUnJ7jb6O2cIblcmR1NUQ","Content-Type":"application/json"}});if(a.data){const e=a.data;this.formulario.conductores[o]={...this.formulario.conductores[o],nombre:`${e.Nombres} ${e.PrimerApellido} ${e.SegundoApellido}`,ci:e.NumeroDocumento,edad:this.calculateAge(e.FechaNacimiento),domicilio:e.Domicilio,licencia:e.NumeroDocumento,categoria:"",alcoholemia:"",vehiculoCorrespondeConductor:"",licDesde:"",licHasta:""},this.conductoresEncontrados.push(this.formulario.conductores[o])}else this.$toast.error("No se encontraron datos del conductor"),alert("Conductor no encontrado")}catch(e){console.error("Error al buscar conductor:",e),e.response&&e.response.data&&e.response.data.error?alert("Error"):alert("Error al buscar conductor")}},calculateAge(o){const e=o.split("/"),a=new Date(e[2],e[1]-1,e[0]),r=new Date;let l=r.getFullYear()-a.getFullYear();const t=r.getMonth()-a.getMonth();return(t<0||0===t&&r.getDate()<a.getDate())&&l--,l},agregarConductor(){this.formulario.conductores.push({ci:"",nombre:"",edad:"",domicilio:"",licencia:"",categoria:"",alcoholemia:"",alcoholemiaHora:"",vehiculoCorrespondeConductor:"",licDesde:"",licHasta:""})},confirmarBuscarVictima(o){const e=this.formulario.victimas[o].ci,a=confirm(`El dato del CI a buscar es ${e}, ¿Está seguro?`);a&&this.buscarVictima(o)},async buscarVictima(o){try{const e=this.formulario.victimas[o].ci;if(!e)return void alert("CI de la víctima es requerido");const a=await P.A.post("http://localhost:5000/segip_service",{ced:e,com:"",nom:"",pat:"",mat:"",fnac:""},{headers:{Authorization:"Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6InNpZy1ycy0wIn0.eyJ1c2VyIjoic29hdCIsInNlcnZpY2UiOiJDZXJ0aWZpY2FkbyBkZSBBY2NpZGVudGVzIGRlIFRyw6Fuc2l0byBTT0FUIiwiaWF0IjoxNzE5NDA3NzI5LCJhdWQiOiJTZXJ2aWNpbyBkZSBJZGVudGlmaWNhY2lvbiBkZSBQZXJzb25hcyIsImlzcyI6Ik1pbmlzdGVyaW8gZGUgR29iaWVybm8ifQ.YmXEQ8LpgNQxsURar6wK6bumB0VJA4ZG6JtqDWjbaNoNGj5Qjs7LHBXeedjHb4BxFj6jgIlpp71r2cjFxlqfehnsVUqNLtqyCz6FmGsiImNJl_Gw-Ll_4Z86Dkjn0X3HGpsG69scUztEW4kC8U1LtlsUnJ7jb6O2cIblcmR1NUQ","Content-Type":"application/json"}});if(a.data){const e=a.data;this.formulario.victimas[o]={...this.formulario.victimas[o],nombre:`${e.Nombres} ${e.PrimerApellido} ${e.SegundoApellido}`,ci:e.NumeroDocumento,com:"",edad:this.calculateAge(e.FechaNacimiento),domicilio:e.Domicilio,fallecidoHerido:"",tipoVictima:"",vehiculoCorrespondeVictima:"Sin Vehículo",auxiliado:""},this.victimasEncontradas.push(this.formulario.victimas[o])}else this.$toast.error("No se encontraron datos de la víctima"),alert("Víctima no encontrada")}catch(e){console.error("Error al buscar víctima:",e),e.response&&e.response.data&&e.response.data.error?alert("Error"):alert("Error al buscar víctima")}},agregarVictima(){this.formulario.victimas.push({nombre:"",ci:"",com:"",edad:"",domicilio:"",fallecidoHerido:"",tipoVictima:"",vehiculoCorrespondeVictima:"",auxiliado:""})}}};const ea=(0,V.A)(oa,[["render",Ke],["__scopeId","data-v-7ef11d7d"]]);var aa=ea;const ra=o=>((0,l.Qi)("data-v-25ed178a"),o=o(),(0,l.jt)(),o),la={class:"hechos"},ta=ra((()=>(0,l.Lk)("h2",null,[(0,l.Lk)("u",null,"LISTA DE HECHOS DE TRÁNSITO")],-1))),ia={class:"table-responsive"},sa={class:"search-container"},na={class:"table table-striped"},ua=ra((()=>(0,l.Lk)("thead",{class:"thead"},[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,"Caso N°"),(0,l.Lk)("th",null,"Día, Hora y Fecha del Hecho"),(0,l.Lk)("th",null,"Placas de Vehículos Implicados"),(0,l.Lk)("th",null,"CI de Conductores Implicados"),(0,l.Lk)("th",null,"Detalles del hecho"),(0,l.Lk)("th",null,"Denunciante"),(0,l.Lk)("th",null,"Registrado por"),(0,l.Lk)("th",null,"Ver Detalles")])],-1))),ca={class:"no-bullets"},da={class:"no-bullets"},ma={class:"detalles-col"},pa={key:0},ha=["onClick"],fa=["onClick"];function ka(o,e,a,i,s,n){const u=(0,l.g2)("ModalFormulario");return(0,l.uX)(),(0,l.CE)("div",la,[ta,(0,l.Lk)("div",ia,[(0,l.Lk)("div",sa,[(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>s.searchQuery=o),placeholder:"Buscar por número de caso, CI de conductores o placa",class:"search-input"},null,512),[[r.Jo,s.searchQuery]])]),(0,l.Lk)("table",na,[ua,(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.formularios,(o=>((0,l.uX)(),(0,l.CE)("tr",{key:o._id},[(0,l.Lk)("td",null,(0,t.v_)(o.hechos[0].casoNumero),1),(0,l.Lk)("td",null,(0,t.v_)(n.formatearFecha(o.hechos[0].diaHoraFecha)),1),(0,l.Lk)("td",null,[(0,l.Lk)("ul",ca,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.vehiculos,(o=>((0,l.uX)(),(0,l.CE)("li",{key:o._id},(0,t.v_)(o.placa),1)))),128))])]),(0,l.Lk)("td",null,[(0,l.Lk)("ul",da,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.conductores,(o=>((0,l.uX)(),(0,l.CE)("li",{key:o._id},(0,t.v_)(o.ci),1)))),128))])]),(0,l.Lk)("td",ma,[(0,l.Lk)("p",null,(0,t.v_)(o.detalle),1)]),(0,l.Lk)("td",null,(0,t.v_)(o.hechos[0].denunciante),1),(0,l.Lk)("td",null,(0,t.v_)(o.usuario),1),(0,l.Lk)("td",null,["administrador"===n.userRole?((0,l.uX)(),(0,l.CE)("div",pa,[(0,l.Lk)("button",{onClick:e=>n.abrirModal(o._id),class:"btn btn-primary"},"Ver detalles",8,ha)])):(0,l.Q3)("",!0),(0,l.Lk)("button",{onClick:e=>n.generarReporte(o._id),class:"btn btn-primary"},"Generar Reporte",8,fa)])])))),128))])])]),s.mostrarModal?((0,l.uX)(),(0,l.Wv)(u,{key:0,formulario:s.formularioActual,formularioId:s.formularioIdSeleccionado,onCerrarModal:n.cerrarModal,onGuardarCambios:n.guardarCambios},null,8,["formulario","formularioId","onCerrarModal","onGuardarCambios"])):(0,l.Q3)("",!0)])}const ba=o=>((0,l.Qi)("data-v-4c7588ae"),o=o(),(0,l.jt)(),o),ga={key:0,class:"modal-overlay"},va={class:"modal-content",id:"elemento-a-pdf"},La=ba((()=>(0,l.Lk)("h1",null,"Formulario",-1))),ya=ba((()=>(0,l.Lk)("div",{class:"subt"},[(0,l.Lk)("h3",null,[(0,l.Lk)("strong",null,"1. Datos del Hecho de Tránsito")])],-1))),Ca={class:"form-group"},Va=ba((()=>(0,l.Lk)("label",{for:"denunciante"},"Denunciante:",-1))),Ua=["readonly"],ja={class:"form-group"},Ia=ba((()=>(0,l.Lk)("label",{for:"casoNumero"},"Caso N°:",-1))),Ea=["readonly"],wa={class:"form-group"},Da=ba((()=>(0,l.Lk)("label",{for:"naturaleza"},"Naturaleza del Hecho:",-1))),Aa=["readonly"],Fa={class:"form-group"},Na=ba((()=>(0,l.Lk)("label",{for:"departamento"},"Departamento:",-1))),Ja=["readonly"],xa={class:"form-group"},Sa=ba((()=>(0,l.Lk)("label",{for:"estacionPolicial"},"Estación Policial:",-1))),za=["readonly"],Xa={class:"form-group"},Ha=ba((()=>(0,l.Lk)("label",{for:"lugar"},"Lugar del Hecho:",-1))),_a=["readonly"],Ba={class:"form-group"},Ra=ba((()=>(0,l.Lk)("label",{for:"diaHoraFecha"},"Día, Hora y Fecha del Hecho:",-1))),Ga=["readonly"],Qa=ba((()=>(0,l.Lk)("div",{class:"subt"},[(0,l.Lk)("h3",null,[(0,l.Lk)("strong",null,"2. Datos de los Vehículos")])],-1))),Oa={key:0,class:"form-group"},Pa={class:"form-group"},$a=["for"],Za=["id","onUpdate:modelValue","readonly"],Ta=["onClick"],qa={class:"form-group"},Ma=["for"],Wa=["id","onUpdate:modelValue","readonly"],Ya={class:"form-group"},Ka=["for"],or=["id","onUpdate:modelValue","readonly"],er={class:"form-group"},ar=["for"],rr=["id","onUpdate:modelValue","readonly"],lr={class:"form-group"},tr=["for"],ir=["id","onUpdate:modelValue","readonly"],sr={class:"form-group"},nr=["for"],ur=["id","onUpdate:modelValue","readonly"],cr={class:"form-group"},dr=["for"],mr=["id","onUpdate:modelValue","readonly"],pr=ba((()=>(0,l.Lk)("div",{class:"subt"},[(0,l.Lk)("h3",null,[(0,l.Lk)("strong",null,"3. Datos de los Conductores")])],-1))),hr={key:1,class:"form-group"},fr={class:"form-group"},kr=["for"],br=["id","onUpdate:modelValue","readonly"],gr=["onClick"],vr={class:"form-group"},Lr=["for"],yr=["id","onUpdate:modelValue","readonly"],Cr={class:"form-group"},Vr=["for"],Ur=["id","onUpdate:modelValue","readonly"],jr={class:"form-group"},Ir=["for"],Er=["id","onUpdate:modelValue","readonly"],wr={class:"form-group"},Dr=["for"],Ar=["id","onUpdate:modelValue","readonly"],Fr={class:"form-group"},Nr=["for"],Jr=["id","onUpdate:modelValue","readonly"],xr={class:"form-group"},Sr=["for"],zr=["id","onUpdate:modelValue","readonly"],Xr={class:"form-group"},Hr=["for"],_r=["id","readonly"],Br={class:"form-group"},Rr=["for"],Gr=["id","onUpdate:modelValue","readonly"],Qr={class:"form-group"},Or=["for"],Pr=["id","onUpdate:modelValue","readonly"],$r={class:"form-group"},Zr=["for"],Tr=["id","onUpdate:modelValue","readonly"],qr=["value"],Mr=ba((()=>(0,l.Lk)("div",{class:"subt"},[(0,l.Lk)("h3",null,[(0,l.Lk)("strong",null,"4. Breve detalle del hecho")])],-1))),Wr={class:"form-group"},Yr=ba((()=>(0,l.Lk)("label",{for:"detalle"},"Detalle del Hecho:",-1))),Kr=["readonly"],ol=ba((()=>(0,l.Lk)("div",{class:"subt"},[(0,l.Lk)("h3",null,[(0,l.Lk)("strong",null,"5. Víctimas del hecho")])],-1))),el={key:2,class:"form-group"},al={class:"form-group"},rl=["for"],ll=["id","onUpdate:modelValue","readonly"],tl=["onClick"],il={class:"form-group"},sl=["for"],nl=["id","onUpdate:modelValue","readonly"],ul={class:"form-group"},cl=["for"],dl=["id","onUpdate:modelValue","readonly"],ml={class:"form-group"},pl=["for"],hl=["id","onUpdate:modelValue","readonly"],fl={class:"form-group"},kl=["for"],bl=["id","onUpdate:modelValue","readonly"],gl=ba((()=>(0,l.Lk)("option",{value:"fallecido"},"Fallecido",-1))),vl=ba((()=>(0,l.Lk)("option",{value:"herido"},"Herido",-1))),Ll=[gl,vl],yl={class:"form-group"},Cl=["for"],Vl=["id","onUpdate:modelValue","readonly"],Ul=ba((()=>(0,l.Lk)("option",{value:"peaton"},"Peatón",-1))),jl=ba((()=>(0,l.Lk)("option",{value:"pasajero"},"Pasajero",-1))),Il=ba((()=>(0,l.Lk)("option",{value:"conductor"},"Conductor",-1))),El=[Ul,jl,Il],wl={class:"form-group"},Dl=["for"],Al=["id","onUpdate:modelValue","readonly"],Fl=ba((()=>(0,l.Lk)("option",{value:"sinVehiculo"},"Sin Vehículo",-1))),Nl=["value"],Jl={class:"form-group"},xl=["for"],Sl=["id","onUpdate:modelValue","readonly"],zl=ba((()=>(0,l.Lk)("div",{class:"subt"},[(0,l.Lk)("h3",null,[(0,l.Lk)("strong",null,"6. Fecha de Registro en el Sistema")])],-1))),Xl={class:"form-group"},Hl=["for"],_l=["id","readonly"],Bl=ba((()=>(0,l.Lk)("div",{class:"subt"},[(0,l.Lk)("h3",null,[(0,l.Lk)("strong",null,"7. Usuario")])],-1))),Rl={class:"form-group"},Gl=ba((()=>(0,l.Lk)("label",{for:"usuario"},"Usuario:",-1))),Ql=["value","readonly"],Ol=ba((()=>(0,l.Lk)("div",{class:"subt"},[(0,l.Lk)("h3",null,[(0,l.Lk)("strong",null,"8. Comentarios")])],-1))),Pl={class:"form-group"},$l=ba((()=>(0,l.Lk)("label",{for:"comentarios"},"Comentarios Adicionales (Opcional):",-1))),Zl=["readonly"],Tl={class:"botones"},ql={key:0},Ml={key:1};function Wl(o,e,a,i,s,n){return a.formulario?((0,l.uX)(),(0,l.CE)("div",ga,[(0,l.Lk)("div",va,[La,ya,(0,l.Lk)("div",Ca,[Va,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"denunciante","onUpdate:modelValue":e[0]||(e[0]=o=>a.formulario.hechos[0].denunciante=o),readonly:!s.editable},null,8,Ua),[[r.Jo,a.formulario.hechos[0].denunciante]])]),(0,l.Lk)("div",ja,[Ia,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"casoNumero","onUpdate:modelValue":e[1]||(e[1]=o=>a.formulario.hechos[0].casoNumero=o),readonly:!s.editable},null,8,Ea),[[r.Jo,a.formulario.hechos[0].casoNumero]])]),(0,l.Lk)("div",wa,[Da,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"naturaleza","onUpdate:modelValue":e[2]||(e[2]=o=>a.formulario.hechos[0].naturaleza=o),readonly:!s.editable},null,8,Aa),[[r.Jo,a.formulario.hechos[0].naturaleza]])]),(0,l.Lk)("div",Fa,[Na,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"departamento","onUpdate:modelValue":e[3]||(e[3]=o=>a.formulario.hechos[0].departamento=o),readonly:!s.editable},null,8,Ja),[[r.Jo,a.formulario.hechos[0].departamento]])]),(0,l.Lk)("div",xa,[Sa,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"estacionPolicial","onUpdate:modelValue":e[4]||(e[4]=o=>a.formulario.hechos[0].estacionPolicial=o),readonly:!s.editable},null,8,za),[[r.Jo,a.formulario.hechos[0].estacionPolicial]])]),(0,l.Lk)("div",Xa,[Ha,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"lugar","onUpdate:modelValue":e[5]||(e[5]=o=>a.formulario.hechos[0].lugar=o),readonly:!s.editable},null,8,_a),[[r.Jo,a.formulario.hechos[0].lugar]])]),(0,l.Lk)("div",Ba,[Ra,(0,l.bo)((0,l.Lk)("input",{type:"datetime-local",id:"diaHoraFecha","onUpdate:modelValue":e[6]||(e[6]=o=>a.formulario.hechos[0].diaHoraFecha=o),readonly:!s.editable},null,8,Ga),[[r.Jo,a.formulario.hechos[0].diaHoraFecha]])]),Qa,s.editable?((0,l.uX)(),(0,l.CE)("div",Oa,[(0,l.Lk)("button",{onClick:e[7]||(e[7]=(...o)=>n.agregarVehiculo&&n.agregarVehiculo(...o))},"+ Añadir Vehículo")])):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.formulario.vehiculos,((o,e)=>((0,l.uX)(),(0,l.CE)("div",{key:e},[(0,l.Lk)("h4",null,"Vehículo "+(0,t.v_)(e+1),1),(0,l.Lk)("div",Pa,[(0,l.Lk)("label",{for:"placa"+e},"Placa:",8,$a),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"placa"+e,"onUpdate:modelValue":e=>o.placa=e,readonly:!s.editable},null,8,Za),[[r.Jo,o.placa]]),s.editable?((0,l.uX)(),(0,l.CE)("button",{key:0,type:"button",onClick:o=>n.confirmarBuscarVehiculo(e)},"Buscar",8,Ta)):(0,l.Q3)("",!0)]),(0,l.Lk)("div",qa,[(0,l.Lk)("label",{for:"marca"+e},"Marca:",8,Ma),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"marca"+e,"onUpdate:modelValue":e=>o.marca=e,readonly:!s.editable},null,8,Wa),[[r.Jo,o.marca]])]),(0,l.Lk)("div",Ya,[(0,l.Lk)("label",{for:"modelo"+e},"Modelo:",8,Ka),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"modelo"+e,"onUpdate:modelValue":e=>o.modelo=e,readonly:!s.editable},null,8,or),[[r.Jo,o.modelo]])]),(0,l.Lk)("div",er,[(0,l.Lk)("label",{for:"clase"+e},"Tipo Vehículo:",8,ar),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"clase"+e,"onUpdate:modelValue":e=>o.clase=e,readonly:!s.editable},null,8,rr),[[r.Jo,o.clase]])]),(0,l.Lk)("div",lr,[(0,l.Lk)("label",{for:"color"+e},"Color:",8,tr),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"color"+e,"onUpdate:modelValue":e=>o.color=e,readonly:!s.editable},null,8,ir),[[r.Jo,o.color]])]),(0,l.Lk)("div",sr,[(0,l.Lk)("label",{for:"empresa"+e},"Empresa o Institución a la que pertenece el vehículo:",8,nr),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"empresa"+e,"onUpdate:modelValue":e=>o.empresa=e,readonly:!s.editable},null,8,ur),[[r.Jo,o.empresa]])]),(0,l.Lk)("div",cr,[(0,l.Lk)("label",{for:"tipoUso"+e},"Tipo de servicio:",8,dr),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"tipoUso"+e,"onUpdate:modelValue":e=>o.tipoUso=e,readonly:!s.editable},null,8,mr),[[r.Jo,o.tipoUso]])])])))),128)),pr,s.editable?((0,l.uX)(),(0,l.CE)("div",hr,[(0,l.Lk)("button",{onClick:e[8]||(e[8]=(...o)=>n.agregarConductor&&n.agregarConductor(...o))},"+ Añadir Conductor")])):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.formulario.conductores,((o,i)=>((0,l.uX)(),(0,l.CE)("div",{key:i},[(0,l.Lk)("h4",null,"Conductor "+(0,t.v_)(i+1),1),(0,l.Lk)("div",fr,[(0,l.Lk)("label",{for:"ci"+i},"CI:",8,kr),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"ci"+i,"onUpdate:modelValue":e=>o.ci=e,readonly:!s.editable},null,8,br),[[r.Jo,o.ci]]),s.editable?((0,l.uX)(),(0,l.CE)("button",{key:0,type:"button",onClick:o=>n.confirmarBuscarConductor(i)},"Buscar",8,gr)):(0,l.Q3)("",!0)]),(0,l.Lk)("div",vr,[(0,l.Lk)("label",{for:"nombre"+i},"Nombre:",8,Lr),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"nombre"+i,"onUpdate:modelValue":e=>o.nombre=e,readonly:!s.editable},null,8,yr),[[r.Jo,o.nombre]])]),(0,l.Lk)("div",Cr,[(0,l.Lk)("label",{for:"edad"+i},"Edad:",8,Vr),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"edad"+i,"onUpdate:modelValue":e=>o.edad=e,readonly:!s.editable},null,8,Ur),[[r.Jo,o.edad]])]),(0,l.Lk)("div",jr,[(0,l.Lk)("label",{for:"domicilio"+i},"Domicilio:",8,Ir),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"domicilio"+i,"onUpdate:modelValue":e=>o.domicilio=e,readonly:!s.editable},null,8,Er),[[r.Jo,o.domicilio]])]),(0,l.Lk)("div",wr,[(0,l.Lk)("label",{for:"licencia"+i},"Licencia de Conducir N°:",8,Dr),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"licencia"+i,"onUpdate:modelValue":e=>o.licencia=e,readonly:!s.editable},null,8,Ar),[[r.Jo,o.licencia]])]),(0,l.Lk)("div",Fr,[(0,l.Lk)("label",{for:"categoria"+i},"Categoría:",8,Nr),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"categoria"+i,"onUpdate:modelValue":e=>o.categoria=e,readonly:!s.editable},null,8,Jr),[[r.Jo,o.categoria]])]),(0,l.Lk)("div",xr,[(0,l.Lk)("label",{for:"licDesde"+i},"Vigencia desde:",8,Sr),(0,l.bo)((0,l.Lk)("input",{type:"datetime-local",id:"licDesde"+i,"onUpdate:modelValue":e=>o.licDesde=e,readonly:!s.editable},null,8,zr),[[r.Jo,o.licDesde]])]),(0,l.Lk)("div",Xr,[(0,l.Lk)("label",{for:"licHasta"+i},"Vigencia hasta::",8,Hr),(0,l.bo)((0,l.Lk)("input",{type:"datetime-local",id:"licHasta"+i,"onUpdate:modelValue":e[9]||(e[9]=o=>n.formattedLicHasta=o),readonly:!s.editable},null,8,_r),[[r.Jo,n.formattedLicHasta]])]),(0,l.Lk)("div",Br,[(0,l.Lk)("label",{for:"alcoholemia"+i},"Resultado Test de Alcoholemia:",8,Rr),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"alcoholemia"+i,"onUpdate:modelValue":e=>o.alcoholemia=e,readonly:!s.editable},null,8,Gr),[[r.Jo,o.alcoholemia]])]),(0,l.Lk)("div",Qr,[(0,l.Lk)("label",{for:"alcoholemiaHora"+i},"Realizado:",8,Or),(0,l.bo)((0,l.Lk)("input",{type:"datetime-local",id:"alcoholemiaHora"+i,"onUpdate:modelValue":e=>o.alcoholemiaHora=e,readonly:!s.editable},null,8,Pr),[[r.Jo,o.alcoholemiaHora]])]),(0,l.Lk)("div",$r,[(0,l.Lk)("label",{for:"vehiculoCorrespondeConductor"+i},"Vehículo al que Correspondía:",8,Zr),(0,l.bo)((0,l.Lk)("select",{id:"vehiculoCorrespondeConductor"+i,"onUpdate:modelValue":e=>o.vehiculoCorrespondeConductor=e,readonly:!s.editable},[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.formulario.vehiculos,((o,e)=>((0,l.uX)(),(0,l.CE)("option",{key:e,value:o.placa},(0,t.v_)(o.placa),9,qr)))),128))],8,Tr),[[r.u1,o.vehiculoCorrespondeConductor]])])])))),128)),Mr,(0,l.Lk)("div",Wr,[Yr,(0,l.bo)((0,l.Lk)("textarea",{id:"detalle","onUpdate:modelValue":e[10]||(e[10]=o=>a.formulario.detalle=o),maxlength:"1000",readonly:!s.editable,class:"textarea1"},null,8,Kr),[[r.Jo,a.formulario.detalle]])]),ol,s.editable?((0,l.uX)(),(0,l.CE)("div",el,[(0,l.Lk)("button",{onClick:e[11]||(e[11]=(...o)=>n.agregarVictima&&n.agregarVictima(...o))},"+ Añadir Víctima")])):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.formulario.victimas,((o,e)=>((0,l.uX)(),(0,l.CE)("div",{key:e},[(0,l.Lk)("h4",null,"Víctima "+(0,t.v_)(e+1),1),(0,l.Lk)("div",al,[(0,l.Lk)("label",{for:"ci"+e},"CI:",8,rl),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"ci"+e,"onUpdate:modelValue":e=>o.ci=e,readonly:!s.editable},null,8,ll),[[r.Jo,o.ci]]),s.editable?((0,l.uX)(),(0,l.CE)("button",{key:0,type:"button",onClick:o=>n.confirmarBuscarVictima(e)},"Buscar",8,tl)):(0,l.Q3)("",!0)]),(0,l.Lk)("div",il,[(0,l.Lk)("label",{for:"nombre"+e},"Nombre:",8,sl),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"nombre"+e,"onUpdate:modelValue":e=>o.nombre=e,readonly:!s.editable},null,8,nl),[[r.Jo,o.nombre]])]),(0,l.Lk)("div",ul,[(0,l.Lk)("label",{for:"edad"+e},"Edad:",8,cl),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"edad"+e,"onUpdate:modelValue":e=>o.edad=e,readonly:!s.editable},null,8,dl),[[r.Jo,o.edad]])]),(0,l.Lk)("div",ml,[(0,l.Lk)("label",{for:"domicilio"+e},"Domicilio:",8,pl),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"domicilio"+e,"onUpdate:modelValue":e=>o.domicilio=e,readonly:!s.editable},null,8,hl),[[r.Jo,o.domicilio]])]),(0,l.Lk)("div",fl,[(0,l.Lk)("label",{for:"fallecidoHerido"+e},"Fallecido o Herido:",8,kl),(0,l.bo)((0,l.Lk)("select",{id:"fallecidoHerido"+e,"onUpdate:modelValue":e=>o.fallecidoHerido=e,readonly:!s.editable},Ll,8,bl),[[r.u1,o.fallecidoHerido]])]),(0,l.Lk)("div",yl,[(0,l.Lk)("label",{for:"tipoVictima"+e},"Tipo de Víctima:",8,Cl),(0,l.bo)((0,l.Lk)("select",{id:"tipoVictima"+e,"onUpdate:modelValue":e=>o.tipoVictima=e,readonly:!s.editable},El,8,Vl),[[r.u1,o.tipoVictima]])]),(0,l.Lk)("div",wl,[(0,l.Lk)("label",{for:"vehiculoCorrespondeVictima"+e},"Vehículo al que Correspondía:",8,Dl),(0,l.bo)((0,l.Lk)("select",{id:"vehiculoCorrespondeVictima"+e,"onUpdate:modelValue":e=>o.vehiculoCorrespondeVictima=e,readonly:!s.editable},[Fl,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.formulario.vehiculos,((o,e)=>((0,l.uX)(),(0,l.CE)("option",{key:e,value:o.placa},(0,t.v_)(o.placa),9,Nl)))),128))],8,Al),[[r.u1,o.vehiculoCorrespondeVictima]])]),(0,l.Lk)("div",Jl,[(0,l.Lk)("label",{for:"auxiliado"+e},"Auxiliado:",8,xl),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"auxiliado"+e,"onUpdate:modelValue":e=>o.auxiliado=e,readonly:!s.editable},null,8,Sl),[[r.Jo,o.auxiliado]])])])))),128)),zl,(0,l.Lk)("div",Xl,[(0,l.Lk)("label",{for:o.fechaRegistro},"Fecha y Hora del Registro en el Sistema:",8,Hl),(0,l.bo)((0,l.Lk)("input",{type:"datetime-local",id:o.fechaRegistro,"onUpdate:modelValue":e[12]||(e[12]=o=>n.formattedFechaRegistro=o),readonly:!s.editable},null,8,_l),[[r.Jo,n.formattedFechaRegistro]])]),Bl,(0,l.Lk)("div",Rl,[Gl,(0,l.Lk)("input",{type:"text",id:"usuario",value:a.formulario.usuario,readonly:!s.editable},null,8,Ql)]),Ol,(0,l.Lk)("div",Pl,[$l,(0,l.bo)((0,l.Lk)("textarea",{id:"comentarios","onUpdate:modelValue":e[13]||(e[13]=o=>a.formulario.comentarios=o),maxlength:"1000",readonly:!s.editable,class:"textarea2"},null,8,Zl),[[r.Jo,a.formulario.comentarios]])]),(0,l.Lk)("div",Tl,[s.editable?((0,l.uX)(),(0,l.CE)("div",Ml,[s.editable?((0,l.uX)(),(0,l.CE)("button",{key:0,onClick:e[15]||(e[15]=(...o)=>n.emitirGuardarCambios&&n.emitirGuardarCambios(...o))},"Guardar Cambios")):(0,l.Q3)("",!0)])):((0,l.uX)(),(0,l.CE)("div",ql,[s.editable?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("button",{key:0,onClick:e[14]||(e[14]=(...o)=>n.habilitarEdicion&&n.habilitarEdicion(...o))},"Modificar Datos"))])),(0,l.Lk)("div",null,[(0,l.Lk)("button",{onClick:e[16]||(e[16]=(...o)=>n.generarReporte&&n.generarReporte(...o))},"Generar Reporte")]),(0,l.Lk)("div",null,[(0,l.Lk)("button",{onClick:e[17]||(e[17]=e=>o.$emit("cerrarModal"))},"Cerrar")])])])])):(0,l.Q3)("",!0)}a(7650);var Yl={name:"ModalFormulario",props:{formulario:{type:Object,required:!0},formularioId:{type:String,required:!0}},data(){return{editable:!1,vehiculosEncontrados:[],conductoresEncontrados:[],victimasEncontradas:[]}},computed:{formattedFechaRegistro(){if(!this.formulario.fechaRegistro)return"";const o=new Date(this.formulario.fechaRegistro);return o.toISOString().slice(0,16)},formattedLicDesde(){if(!this.formulario.licDesde)return"";const o=new Date(this.formulario.licDesde);return o.toISOString().slice(0,16)},formattedLicHasta(){if(!this.formulario.licHasta)return"";const o=new Date(this.formulario.licHasta);return o.toISOString().slice(0,16)}},methods:{agregarVehiculo(){this.formulario.vehiculos.push({placa:"",marca:"",modelo:"",clase:"",color:"",empresa:"",tipoUso:""})},agregarConductor(){this.formulario.conductores.push({ci:"",nombre:"",edad:"",domicilio:"",licencia:"",categoria:"",alcoholemia:"",alcoholemiaHora:"",vehiculoCorrespondeConductor:"",licDesde:"",licHasta:""})},agregarVictima(){this.formulario.victimas.push({nombre:"",ci:"",edad:"",domicilio:"",fallecidoHerido:"",tipoVictima:"",vehiculoCorrespondeVictima:"",auxiliado:""})},cerrarModal(){this.$emit("cerrar")},habilitarEdicion(){this.editable=!0},emitirGuardarCambios(){this.$emit("guardarCambios",this.formulario,this.formulario._id)},async confirmarBuscarVehiculo(o){const e=this.formulario.vehiculos[o].placa,a=confirm(`El dato de la placa a buscar es ${e}, ¿Está seguro?`);a&&this.buscarVehiculo(o)},async buscarVehiculo(o){const e=this.formulario.vehiculos[o],a={contrasenia:"d1u4EeXYnp8Xy5h2xWbTz4o0X8EfUhihOwF7Ejd9wrJYQNXkbzCVG7PU7AWndEMDJujblbUcQnO884pdlEMA==",usuario:"MinGobDNFRServicio",token_key_MG:"P7ehC5HPARluSshmhjb4rmfULceEqO0ku5QhT5iXs3YAMlEUiEbYd6CwQKKrb2RvoT4hHz1Hw6Pm8pRMbshjw==",placa:e.placa};try{console.log("Datos de la solicitud:",a);const r=await P.A.post("https://srvweb.policiadnfr.gob.bo/api/ConsultaVehiculo/ServicioMinGob",a);if(console.log("Respuesta del servidor:",r),r.data&&r.data.datos_vehiculo){console.log("Datos del vehículo:",r.data.datos_vehiculo);const a=r.data.datos_vehiculo;delete a.fotografia;const l=this.vehiculosEncontrados.find((o=>o.placa===e.placa));l?alert("El vehículo ya ha sido agregado."):(this.formulario.vehiculos.splice(o,1,a),this.vehiculosEncontrados.push(a))}else console.log("No se encontraron datos del vehículo")}catch(r){console.error("Error al buscar el vehículo:",r)}},confirmarBuscarConductor(o){const e=this.formulario.conductores[o].ci,a=confirm(`El dato del CI a buscar es ${e}, ¿Está seguro?`);a&&this.buscarConductor(o)},async buscarConductor(o){try{const e=this.formulario.conductores[o].ci;if(!e)return void alert("CI del conductor es requerido");const a=await P.A.post("http://localhost:5000/segip_service",{ced:e,com:"",nom:"",pat:"",mat:"",fnac:""},{headers:{Authorization:"Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6InNpZy1ycy0wIn0.eyJ1c2VyIjoic29hdCIsInNlcnZpY2UiOiJDZXJ0aWZpY2FkbyBkZSBBY2NpZGVudGVzIGRlIFRyw6Fuc2l0byBTT0FUIiwiaWF0IjoxNzE5NDA3NzI5LCJhdWQiOiJTZXJ2aWNpbyBkZSBJZGVudGlmaWNhY2lvbiBkZSBQZXJzb25hcyIsImlzcyI6Ik1pbmlzdGVyaW8gZGUgR29iaWVybm8ifQ.YmXEQ8LpgNQxsURar6wK6bumB0VJA4ZG6JtqDWjbaNoNGj5Qjs7LHBXeedjHb4BxFj6jgIlpp71r2cjFxlqfehnsVUqNLtqyCz6FmGsiImNJl_Gw-Ll_4Z86Dkjn0X3HGpsG69scUztEW4kC8U1LtlsUnJ7jb6O2cIblcmR1NUQ","Content-Type":"application/json"}});if(a.data){const e=a.data;this.formulario.conductores[o]={...this.formulario.conductores[o],nombre:`${e.Nombres} ${e.PrimerApellido} ${e.SegundoApellido}`,ci:e.NumeroDocumento,edad:this.calculateAge(e.FechaNacimiento),domicilio:e.Domicilio,licencia:"",categoria:"",alcoholemia:"",alcoholemiaHora:"",vehiculoCorrespondeConductor:"",licDesde:"",licHasta:""},this.conductoresEncontrados.push(this.formulario.conductores[o])}else this.$toast.error("No se encontraron datos del conductor"),alert("Conductor no encontrado")}catch(e){console.error("Error al buscar conductor:",e),e.response&&e.response.data&&e.response.data.error?alert("Error"):alert("Error al buscar conductor")}},calculateAge(o){const e=o.split("/"),a=new Date(e[2],e[1]-1,e[0]),r=new Date;let l=r.getFullYear()-a.getFullYear();const t=r.getMonth()-a.getMonth();return(t<0||0===t&&r.getDate()<a.getDate())&&l--,l},confirmarBuscarVictima(o){const e=this.formulario.victimas[o].ci,a=confirm(`El dato del CI a buscar es ${e}, ¿Está seguro?`);a&&this.buscarVictima(o)},async buscarVictima(o){try{const e=this.formulario.victimas[o].ci;if(!e)return void alert("CI de la víctima es requerido");const a=await P.A.post("http://localhost:5000/segip_service",{ced:e,com:"",nom:"",pat:"",mat:"",fnac:""},{headers:{Authorization:"Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6InNpZy1ycy0wIn0.eyJ1c2VyIjoic29hdCIsInNlcnZpY2UiOiJDZXJ0aWZpY2FkbyBkZSBBY2NpZGVudGVzIGRlIFRyw6Fuc2l0byBTT0FUIiwiaWF0IjoxNzE5NDA3NzI5LCJhdWQiOiJTZXJ2aWNpbyBkZSBJZGVudGlmaWNhY2lvbiBkZSBQZXJzb25hcyIsImlzcyI6Ik1pbmlzdGVyaW8gZGUgR29iaWVybm8ifQ.YmXEQ8LpgNQxsURar6wK6bumB0VJA4ZG6JtqDWjbaNoNGj5Qjs7LHBXeedjHb4BxFj6jgIlpp71r2cjFxlqfehnsVUqNLtqyCz6FmGsiImNJl_Gw-Ll_4Z86Dkjn0X3HGpsG69scUztEW4kC8U1LtlsUnJ7jb6O2cIblcmR1NUQ","Content-Type":"application/json"}});if(a.data){const e=a.data;this.formulario.victimas[o]={...this.formulario.victimas[o],nombre:`${e.Nombres} ${e.PrimerApellido} ${e.SegundoApellido}`,ci:e.NumeroDocumento,edad:this.calculateAge(e.FechaNacimiento),domicilio:e.Domicilio,fallecidoHerido:"",tipoVictima:"",vehiculoCorrespondeVictima:"Sin Vehículo",auxiliado:""},this.victimasEncontradas.push(this.formulario.victimas[o])}else this.$toast.error("No se encontraron datos de la víctima"),alert("Víctima no encontrada")}catch(e){console.error("Error al buscar víctima:",e),e.response&&e.response.data&&e.response.data.error?alert("Error"):alert("Error al buscar víctima")}},calculateAge(o){const e=o.split("/"),a=new Date(e[2],e[1]-1,e[0]),r=new Date;let l=r.getFullYear()-a.getFullYear();const t=r.getMonth()-a.getMonth();return(t<0||0===t&&r.getDate()<a.getDate())&&l--,l},async generarReporte(){try{const o=await P.A.get(`http://localhost:5000/api/accidentes/reporte/${this.formularioId}`,{responseType:"blob"}),e=window.URL.createObjectURL(new Blob([o.data])),a=document.createElement("a");a.href=e,a.setAttribute("download",`Caso N° ${this.formulario.hechos[0].casoNumero}.pdf`),document.body.appendChild(a),a.click(),document.body.removeChild(a)}catch(o){console.error("Error generando el reporte:",o)}}}};const Kl=(0,V.A)(Yl,[["render",Wl],["__scopeId","data-v-4c7588ae"]]);var ot=Kl,et={name:"Hechos",components:{ModalFormulario:ot},data(){return{searchQuery:"",formularios:[],mostrarModal:!1,formularioIdSeleccionado:null,formularioActual:null}},computed:{filteredFormularios(){const o=this.searchQuery.toLowerCase().trim();return o?this.formularios.filter((e=>{const a=e.hechos&&e.hechos.length>0?e.hechos[0].casoNumero.toString().toLowerCase():"",r=a.includes(o),l=!!(e.conductores&&e.conductores.length>0)&&e.conductores.some((e=>e.ci.toString().toLowerCase().includes(o))),t=!!(e.vehiculos&&e.vehiculos.length>0)&&e.vehiculos.some((e=>e.placa.toLowerCase().includes(o)));return console.log(this.formularios),r||l||t})):this.formularios}},methods:{buscar(){},formatearFecha(o){const e={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},a=new Date(o).toLocaleDateString("es-ES",e);return a},async fetchFormularios(){try{const o=await P.A.get("http://127.0.0.1:5000/api/accidentes");console.log("response",o),this.formularios=o.data.sort(((o,e)=>new Date(e.hechos[0].diaHoraFecha)-new Date(o.hechos[0].diaHoraFecha)))}catch(o){console.error("Error al obtener accidentes:",o)}},async cargarFormularios(){try{const o=await P.A.get("http://127.0.0.1:5000/api/accidentes");this.formularios=o.data.sort(((o,e)=>new Date(e.hechos[0].diaHoraFecha)-new Date(o.hechos[0].diaHoraFecha)))}catch(o){console.error("Error al obtener los formularios:",o)}},async abrirModal(o){this.formularioIdSeleccionado=o;try{const e=await P.A.get(`http://127.0.0.14:5000/api/accidentes/formulario/${o}`);this.formularioActual=e.data,this.mostrarModal=!0}catch(e){console.error("Error al obtener los detalles del formulario:",e)}},async guardarCambios(o,e){try{const a=await P.A.put(`http://127.0.0.1:5000/api/accidentes/${e}`,o);console.log("Formulario actualizado:",a.data);const r=this.formularios.findIndex((o=>o._id===e));-1!==r&&(this.formularios[r]=a.data),this.cerrarModal()}catch(a){console.error("Error actualizando formulario:",a)}},cerrarModal(){this.mostrarModal=!1,this.formularioIdSeleccionado=null,this.formularioActual=null},async generarReporte(o){try{const e=await P.A.get(`http://localhost:5000/api/accidentes/reporte/${o}`,{responseType:"blob"}),a=this.formularios.find((e=>e._id===o));if(!a)return void console.error("No se encontró el formulario");const r=window.URL.createObjectURL(new Blob([e.data])),l=document.createElement("a");l.href=r,l.setAttribute("download",`Caso N° ${a.hechos[0].casoNumero}.pdf`),document.body.appendChild(l),l.click(),document.body.removeChild(l)}catch(e){console.error("Error generando el reporte:",e)}}},async created(){this.cargarFormularios(),this.fetchFormularios()},mounted(){},computed:{userRole(){const o=JSON.parse(localStorage.getItem("userData"));return o?o.rol:null}}};const at=(0,V.A)(et,[["render",ka],["__scopeId","data-v-25ed178a"]]);var rt=at;const lt=(0,l.Lk)("p",null,"Cerrando sesión...",-1),tt=[lt];function it(o,e,a,r,t,i){return(0,l.uX)(),(0,l.CE)("div",null,tt)}var st={name:"Logout",created(){localStorage.removeItem("userId"),localStorage.removeItem("token"),localStorage.removeItem("userData"),this.$router.push("/")}};const nt=(0,V.A)(st,[["render",it]]);var ut=nt;const ct=o=>((0,l.Qi)("data-v-c51fe014"),o=o(),(0,l.jt)(),o),dt={class:"usuarios-container"},mt={class:"usuarios"},pt=ct((()=>(0,l.Lk)("h2",{class:"titulo"},"Usuarios Registrados",-1))),ht={class:"search-container"},ft={class:"table-container"},kt=ct((()=>(0,l.Lk)("th",null,"Nombre",-1))),bt=ct((()=>(0,l.Lk)("th",null,"Apellidos",-1))),gt=ct((()=>(0,l.Lk)("th",null,"Carnet",-1))),vt=ct((()=>(0,l.Lk)("th",null,"Grado",-1))),Lt=ct((()=>(0,l.Lk)("th",null,"Usuario",-1))),yt={key:0},Ct={key:0},Vt=["onClick"];function Ut(o,e,a,i,s,n){return(0,l.uX)(),(0,l.CE)("div",dt,[(0,l.Lk)("div",mt,[pt,(0,l.Lk)("div",ht,[(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>s.searchQuery=o),placeholder:"Buscar usuario",class:"search-input"},null,512),[[r.Jo,s.searchQuery]])]),(0,l.Lk)("div",ft,[(0,l.Lk)("table",null,[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[kt,bt,gt,vt,Lt,a.isAdmin?((0,l.uX)(),(0,l.CE)("th",yt,"Acciones")):(0,l.Q3)("",!0)])]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.filteredUsuarios,(o=>((0,l.uX)(),(0,l.CE)("tr",{key:o._id},[(0,l.Lk)("td",null,(0,t.v_)(o.nombre),1),(0,l.Lk)("td",null,(0,t.v_)(o.apellidos),1),(0,l.Lk)("td",null,(0,t.v_)(o.carnet),1),(0,l.Lk)("td",null,(0,t.v_)(o.grado),1),(0,l.Lk)("td",null,(0,t.v_)(o.usuario),1),a.isAdmin?((0,l.uX)(),(0,l.CE)("td",Ct,[(0,l.Lk)("button",{class:"btn-editar",onClick:e=>n.editarUsuario(o._id)},"Editar",8,Vt)])):(0,l.Q3)("",!0)])))),128))])])])])])}var jt={name:"Usuarios",props:{isAdmin:Boolean},data(){return{usuarios:[],searchQuery:""}},created(){const o=localStorage.getItem("token");P.A.get("http://127.0.0.1:5000/api/usuarios",{headers:{Authorization:`Bearer ${o}`}}).then((o=>{this.usuarios=o.data})).catch((o=>{console.log(o)}))},computed:{filteredUsuarios(){const o=this.searchQuery.toLowerCase().trim();return o?this.usuarios.filter((e=>e.nombre.toLowerCase().includes(o)||e.apellidos.toLowerCase().includes(o)||e.carnet.toLowerCase().includes(o)||e.grado.toLowerCase().includes(o)||e.usuario.toLowerCase().includes(o))):this.usuarios}},methods:{editarUsuario(o){this.$router.push(`/editar-usuario/${o}`)}}};const It=(0,V.A)(jt,[["render",Ut],["__scopeId","data-v-c51fe014"]]);var Et=It;const wt=o=>((0,l.Qi)("data-v-2e781c48"),o=o(),(0,l.jt)(),o),Dt={class:"editar-usuario-container"},At={class:"editar-usuario"},Ft=wt((()=>(0,l.Lk)("h2",null,"Editar Usuario",-1))),Nt={class:"form-group"},Jt=wt((()=>(0,l.Lk)("label",{for:"nombre"},"Nombre:",-1))),xt={class:"form-group"},St=wt((()=>(0,l.Lk)("label",{for:"apellidos"},"Apellidos:",-1))),zt={class:"form-group"},Xt=wt((()=>(0,l.Lk)("label",{for:"carnet"},"Carnet:",-1))),Ht={class:"form-group"},_t=wt((()=>(0,l.Lk)("label",{for:"grado"},"Grado:",-1))),Bt={class:"form-group"},Rt=wt((()=>(0,l.Lk)("label",{for:"usuario"},"Usuario:",-1))),Gt={class:"form-group"},Qt=wt((()=>(0,l.Lk)("label",{for:"rol"},"Rol:",-1))),Ot=wt((()=>(0,l.Lk)("option",{value:"usuario"},"Usuario",-1))),Pt=wt((()=>(0,l.Lk)("option",{value:"administrador"},"Administrador",-1))),$t=[Ot,Pt],Zt={class:"form-actions"},Tt=wt((()=>(0,l.Lk)("button",{type:"submit",class:"btn-guardar"},"Guardar Cambios",-1)));function qt(o,e,a,t,i,s){return(0,l.uX)(),(0,l.CE)("div",Dt,[(0,l.Lk)("div",At,[Ft,(0,l.Lk)("form",{onSubmit:e[7]||(e[7]=(0,r.D$)(((...o)=>s.actualizarUsuario&&s.actualizarUsuario(...o)),["prevent"]))},[(0,l.Lk)("div",Nt,[Jt,(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>i.usuario.nombre=o),required:""},null,512),[[r.Jo,i.usuario.nombre]])]),(0,l.Lk)("div",xt,[St,(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>i.usuario.apellidos=o),required:""},null,512),[[r.Jo,i.usuario.apellidos]])]),(0,l.Lk)("div",zt,[Xt,(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=o=>i.usuario.carnet=o),required:""},null,512),[[r.Jo,i.usuario.carnet]])]),(0,l.Lk)("div",Ht,[_t,(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>i.usuario.grado=o),required:""},null,512),[[r.Jo,i.usuario.grado]])]),(0,l.Lk)("div",Bt,[Rt,(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=o=>i.usuario.usuario=o),required:""},null,512),[[r.Jo,i.usuario.usuario]])]),(0,l.Lk)("div",Gt,[Qt,(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>i.usuario.rol=o),required:""},$t,512),[[r.u1,i.usuario.rol]])]),(0,l.Lk)("div",Zt,[(0,l.Lk)("button",{type:"button",class:"btn-eliminar",onClick:e[6]||(e[6]=(...o)=>s.eliminarUsuario&&s.eliminarUsuario(...o))},"Eliminar Usuario"),Tt])],32)])])}var Mt={name:"EditarUsuario",data(){return{usuario:{nombre:"",apellidos:"",carnet:"",grado:"",usuario:"",rol:""}}},created(){const o=this.$route.params.id,e=localStorage.getItem("token");P.A.get(`http://127.0.0.1:5000/api/usuarios/${o}`,{headers:{Authorization:`Bearer ${e}`}}).then((o=>{this.usuario=o.data})).catch((o=>{console.log(o)})),this.cargarUsuario()},methods:{cargarUsuario(){const o=this.$route.params.id,e=localStorage.getItem("token");P.A.get(`http://127.0.0.1:5000/api/usuarios/${o}`,{headers:{Authorization:`Bearer ${e}`}}).then((o=>{this.usuario=o.data})).catch((o=>{console.log(o)}))},actualizarUsuario(){const o=this.$route.params.id,e=localStorage.getItem("token");P.A.put(`http://127.0.0.1:5000/api/usuarios/${o}`,this.usuario,{headers:{Authorization:`Bearer ${e}`}}).then((o=>{alert("Usuario actualizado correctamente"),this.$router.push("/usuarios")})).catch((o=>{console.log(o)}))},eliminarUsuario(){const o=this.$route.params.id,e=localStorage.getItem("token");confirm("¿Estás seguro de eliminar este usuario?")&&P.A.delete(`http://127.0.0.1:5000/api/usuarios/${o}`,{headers:{Authorization:`Bearer ${e}`}}).then((o=>{alert("Usuario eliminado correctamente"),this.$router.push("/usuarios")})).catch((o=>{console.log(o),alert("Error al eliminar ususario")}))}}};const Wt=(0,V.A)(Mt,[["render",qt],["__scopeId","data-v-2e781c48"]]);var Yt=Wt;const Kt=[{path:"/",name:"Login",component:q},{path:"/register",name:"Register",component:Vo,meta:{requiresAdmin:!0}},{path:"/formulario",name:"Formulario",component:aa,meta:{requiresAuth:!0}},{path:"/hechos",name:"Hechos",component:rt,meta:{requiresAuth:!0}},{path:"/logout",name:"Logout",component:ut,meta:{requiresAuth:!0}},{path:"/usuarios",name:"Usuarios",component:Et,meta:{requiresAuth:!0}},{path:"/modal-formulario/:id",name:"ModalFormulario",component:ot,props:!0},{path:"/editar-usuario/:id",name:"EditarUsuario",component:Yt,meta:{requiresAuth:!0,requiresAdmin:!0}}],oi=(0,I.aE)({history:(0,I.LA)(),routes:Kt});oi.beforeEach(((o,e,a)=>{if(o.matched.some((o=>o.meta.requiresAuth))){const e=localStorage.getItem("userId"),l=localStorage.getItem("token"),t=localStorage.getItem("userData");if(e&&l)try{const e=t?JSON.parse(t):null;o.matched.some((o=>o.meta.requiresAdmin))&&e&&"administrador"!==e.rol?(alert("No tienes permiso para acceder a esta página."),a({name:"Formulario"})):a()}catch(r){console.error("Error al analizar userData:",r),localStorage.removeItem("userData"),a({name:"Login"})}else a({name:"Login"})}else a()}));var ei=oi,ai=(a(7917),a(5524),a(7204));(0,ai.$N)({theme:{defaultTheme:"light",themes:{light:{colors:{primary:"#1976D2",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"}}}}});const ri=(0,r.Ef)(j);ri.use($.Ay,{position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1}),P.A.interceptors.request.use((o=>{const e=localStorage.getItem("token");return e&&(o.headers.Authorization=`Bearer ${e}`),o}),(o=>Promise.reject(o))),ei.beforeEach(((o,e,a)=>{const r=["/","/register","/logout"],l=!r.includes(o.path),t=localStorage.getItem("token");if(l&&!t)return a("/");a()})),ri.use(ei),ri.mount("#app")}},e={};function a(r){var l=e[r];if(void 0!==l)return l.exports;var t=e[r]={id:r,loaded:!1,exports:{}};return o[r].call(t.exports,t,t.exports,a),t.loaded=!0,t.exports}a.m=o,function(){var o=[];a.O=function(e,r,l,t){if(!r){var i=1/0;for(c=0;c<o.length;c++){r=o[c][0],l=o[c][1],t=o[c][2];for(var s=!0,n=0;n<r.length;n++)(!1&t||i>=t)&&Object.keys(a.O).every((function(o){return a.O[o](r[n])}))?r.splice(n--,1):(s=!1,t<i&&(i=t));if(s){o.splice(c--,1);var u=l();void 0!==u&&(e=u)}}return e}t=t||0;for(var c=o.length;c>0&&o[c-1][2]>t;c--)o[c]=o[c-1];o[c]=[r,l,t]}}(),function(){a.d=function(o,e){for(var r in e)a.o(e,r)&&!a.o(o,r)&&Object.defineProperty(o,r,{enumerable:!0,get:e[r]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(o){if("object"===typeof window)return window}}()}(),function(){a.o=function(o,e){return Object.prototype.hasOwnProperty.call(o,e)}}(),function(){a.r=function(o){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}}(),function(){a.nmd=function(o){return o.paths=[],o.children||(o.children=[]),o}}(),function(){var o={524:0};a.O.j=function(e){return 0===o[e]};var e=function(e,r){var l,t,i=r[0],s=r[1],n=r[2],u=0;if(i.some((function(e){return 0!==o[e]}))){for(l in s)a.o(s,l)&&(a.m[l]=s[l]);if(n)var c=n(a)}for(e&&e(r);u<i.length;u++)t=i[u],a.o(o,t)&&o[t]&&o[t][0](),o[t]=0;return a.O(c)},r=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=a.O(void 0,[504],(function(){return a(1139)}));r=a.O(r)})();
//# sourceMappingURL=app.689ec9f3.js.map